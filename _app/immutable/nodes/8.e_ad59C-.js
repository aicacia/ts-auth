import{f as P,a as j,c as nt}from"../chunks/BAGX8FWs.js";import{p as Ie,A as F,b as u,f as Te,s as i,c as r,g as e,B as $,t as G,a as we,h as s,r as t,u as gt,a5 as yt,$ as It}from"../chunks/9Y3Zi9LS.js";import{d as He,s as v,i as Ce,e as tt,h as wt}from"../chunks/CdK4JjYi.js";import{d as ne,b as X,e as St,r as pe,t as Kt}from"../chunks/DBRB63xn.js";import{p as Y,b as kt}from"../chunks/ClwBco7U.js";import"../chunks/DkEC4_bh.js";import{b as $e}from"../chunks/Bluxw1Nt.js";import{G as st,d as lt,o as dt,I as re,t as Et,p as Tt,q as Ct,r as Nt,s as At,w as jt,x as Bt,y as Dt,z as Pt,A as Ot,B as Mt,D as Ht,E as Lt,F as Ft,H as Gt,b as be,m as ot,C as Q,g as ae,v as W,N as We,i as ut,J as Rt,K as Ut,j as rt,S as at,L as Vt,M as qt,O as Yt,P as Zt,Q as zt,R as Jt,T as Qt,U as Wt,V as Xt,W as $t,X as er,Y as tr,Z as rr,_ as ar,$ as nr,a0 as ir}from"../chunks/CbLLult4.js";import{A as et,t as Le}from"../chunks/Dyl6cX5U.js";import{M as Xe,D as sr,P as lr,T as dr,E as or,a as ur}from"../chunks/D7DzHFmv.js";import{o as cr}from"../chunks/pO33VYKk.js";import{P as vr}from"../chunks/CgwKfw83.js";import{g as _r}from"../chunks/uhMkHT6K.js";import{E as fr}from"../chunks/CB7uGllH.js";import{C as pr}from"../chunks/B40CaONp.js";const ct=["HS256","HS384","HS512"],br=()=>st((_,n)=>{n.length&&(ot(n),Q("algorithm",ae(),()=>{W(_.algorithm).isNotBlank()}),We(!_.audience,()=>{Q("audience",ae(),()=>{W(_.audience).isNotBlank()})}),Q("expiresInSeconds",ae(),()=>{W(_.expiresInSeconds).isNotBlank()}),Q("issuer",ae(),()=>{W(_.issuer).isNotBlank()}),We(_.isNew,()=>{Q("clientId",ae(),()=>{W(_.clientId).isNotBlank()}),Q("privateKey",ae(),()=>{W(_.privateKey).isNotBlank()})}),We(ct.includes(_.algorithm),()=>{Q("publicKey",ae(),()=>{W(_.publicKey).isNotBlank()})}),Q("refreshExpiresInSeconds",ae(),()=>{W(_.refreshExpiresInSeconds).isNotBlank()}))});var mr=P("<option> </option>"),hr=P('<div class="mb-2"><label for="algorithm"> </label> <select name="algorithm"></select> <!></div> <div class="mb-2"><label for="audience"> </label> <input type="text" name="audience"/> <!></div> <div class="mb-2"><label for="clientId"> </label> <input type="text" name="clientId"/> <!></div> <div class="mb-2"><label for="expiresInSeconds"> </label> <input type="number" min="0" name="expiresInSeconds"/> <!></div> <div class="mb-2"><label for="issuer"> </label> <input type="text" name="issuer"/> <!></div> <div class="mb-2"><label for="publicKey"> </label> <input type="text" name="publicKey"/> <!></div> <div class="mb-2"><label for="privateKey"> </label> <!> <!></div> <div class="mb-2"><label for="refreshExpiresInSeconds"> </label> <input type="number" min="0" name="refreshExpiresInSeconds"/> <!></div>',1);function vt(_,n){Ie(n,!0);let l=Y(n,"algorithm",31,()=>F(et.Hs256)),p=Y(n,"audience",15),C=Y(n,"clientId",15),b=Y(n,"expiresInSeconds",15,86400),k=Y(n,"issuer",15,""),S=Y(n,"privateKey",15,""),g=Y(n,"publicKey",15),N=Y(n,"refreshExpiresInSeconds",15,604800),A=Y(n,"isNew",3,!1),K=Y(n,"valid",15,!1),m=br(),y=u(F(m.get())),h=$(()=>ut(e(y),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const o=new Set,I=lt(()=>{m({algorithm:l(),audience:p(),clientId:C(),expiresInSeconds:b(),issuer:k(),privateKey:S(),publicKey:g(),refreshExpiresInSeconds:N(),isNew:A()},Array.from(o)).done(O=>{s(y,O,!0),K(e(y).isValid())}),o.clear()},300);function M(){o.add("algorithm"),o.add("audience"),o.add("clientId"),o.add("expiresInSeconds"),o.add("issuer"),o.add("privateKey"),o.add("publicKey"),o.add("refreshExpiresInSeconds"),I(),I.flush()}function E(O){o.add(O.currentTarget.name),I()}cr(M);var R=hr(),H=Te(R),a=r(H),T=r(a,!0);t(a);var f=i(a,2);f.__input=E,dt(f,20,()=>Object.values(et),O=>O,(O,le,Pe,ve)=>{var te=mr(),_e={},ye=r(te,!0);t(te),G(()=>{_e!==(_e=le)&&(te.value=(te.__value=le)??""),v(ye,le)}),j(O,te)}),t(f);var B=i(f,2);re(B,{name:"algorithm",get result(){return e(y)}}),t(H);var Z=i(H,2),V=r(Z),Fe=r(V,!0);t(V);var z=i(V,2);pe(z),z.__input=E;var Ge=i(z,2);re(Ge,{name:"audience",get result(){return e(y)}}),t(Z);var de=i(Z,2),Se=r(de),Ne=r(Se,!0);t(Se);var ie=i(Se,2);pe(ie),ie.__input=E;var Ae=i(ie,2);re(Ae,{name:"clientId",get result(){return e(y)}}),t(de);var me=i(de,2),he=r(me),Re=r(he,!0);t(he);var c=i(he,2);pe(c),c.__input=E;var d=i(c,2);re(d,{name:"expiresInSeconds",get result(){return e(y)}}),t(me);var x=i(me,2),w=r(x),D=r(w,!0);t(w);var U=i(w,2);pe(U),U.__input=E;var L=i(U,2);re(L,{name:"issuer",get result(){return e(y)}}),t(x);var xe=i(x,2),oe=r(xe),Ue=r(oe,!0);t(oe);var J=i(oe,2);pe(J),J.__input=E;var Ve=i(J,2);re(Ve,{name:"publicKey",get result(){return e(y)}}),t(xe);var ue=i(xe,2),Ke=r(ue),ke=r(Ke,!0);t(Ke);var je=i(Ke,2);const Be=$(()=>e(h)("privateKey")),De=$(()=>Rt());vr(je,{get class(){return`w-full ${e(Be)??""}`},name:"privateKey",get placeholder(){return e(De)},oninput:E,get value(){return S()},set value(O){S(O)}});var qe=i(je,2);re(qe,{name:"privateKey",get result(){return e(y)}}),t(ue);var ce=i(ue,2),ee=r(ce),se=r(ee,!0);t(ee);var q=i(ee,2);pe(q),q.__input=E;var ge=i(q,2);re(ge,{name:"refreshExpiresInSeconds",get result(){return e(y)}}),t(ce),G((O,le,Pe,ve,te,_e,ye,Ye,Ee,Ze,Oe,Me,ze,fe,Je,Qe,_t,ft,pt,bt,mt,ht,xt)=>{v(T,O),ne(f,1,`w-full ${le??""}`),X(f,"placeholder",Pe),v(Fe,ve),ne(z,1,`w-full ${te??""}`),X(z,"placeholder",_e),v(Ne,ye),ne(ie,1,`w-full ${Ye??""}`),X(ie,"placeholder",Ee),v(Re,Ze),ne(c,1,`w-full ${Oe??""}`),X(c,"placeholder",Me),v(D,ze),ne(U,1,`w-full ${fe??""}`),X(U,"placeholder",Je),xe.hidden=Qe,v(Ue,_t),ne(J,1,`w-full ${ft??""}`),X(J,"placeholder",pt),v(ke,bt),v(se,mt),ne(q,1,`w-full ${ht??""}`),X(q,"placeholder",xt)},[()=>Et(),()=>e(h)("algorithm"),()=>Tt(),()=>Ct(),()=>e(h)("audience"),()=>Nt(),()=>At(),()=>e(h)("clientId"),()=>jt(),()=>Bt(),()=>e(h)("expiresInSeconds"),()=>Dt(),()=>Pt(),()=>e(h)("issuer"),()=>Ot(),()=>ct.includes(l()),()=>Mt(),()=>e(h)("publicKey"),()=>Ht(),()=>Lt(),()=>Ft(),()=>e(h)("refreshExpiresInSeconds"),()=>Gt()]),St(f,l),be(z,p),be(ie,C),be(c,b),be(U,k),be(J,g),be(q,N),j(_,R),we()}He(["input"]);var xr=P('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),gr=P('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function yr(_,n){Ie(n,!0);let l=u(!1),p=u(!1),C=$(()=>e(l)||!e(p)),b=u(F(et.Hs256)),k=u(""),S=u(""),g=u(86400),N=u(""),A=u(""),K=u(""),m=u(604800);async function y(a){a.preventDefault();try{s(l,!0),e(p)&&n.onCreate(await Le.createTenant({algorithm:e(b),audience:e(k),clientId:e(S)?e(S):void 0,expiresInSeconds:e(g),issuer:e(N),privateKey:e(A)?e(A):void 0,publicKey:e(K)?e(K):void 0,refreshExpiresInSeconds:e(m)},n.applicationId))}catch(T){await rt(T)}finally{s(l,!1)}}var h=gr(),o=r(h);vt(o,{isNew:!0,get algorithm(){return e(b)},set algorithm(a){s(b,a,!0)},get audience(){return e(k)},set audience(a){s(k,a,!0)},get clientId(){return e(S)},set clientId(a){s(S,a,!0)},get expiresInSeconds(){return e(g)},set expiresInSeconds(a){s(g,a,!0)},get issuer(){return e(N)},set issuer(a){s(N,a,!0)},get privateKey(){return e(A)},set privateKey(a){s(A,a,!0)},get publicKey(){return e(K)},set publicKey(a){s(K,a,!0)},get refreshExpiresInSeconds(){return e(m)},set refreshExpiresInSeconds(a){s(m,a,!0)},get valid(){return e(p)},set valid(a){s(p,a,!0)}});var I=i(o,2),M=r(I),E=r(M);{var R=a=>{var T=xr(),f=r(T),B=r(f);at(B),t(f),t(T),j(a,T)};Ce(E,a=>{e(l)&&a(R)})}var H=i(E);t(M),t(I),t(h),G(a=>{M.disabled=e(C),v(H,` ${a??""}`)},[()=>Ut()]),tt("submit",h,y),j(_,h),we()}const Ir=()=>st((_={},n)=>{n.length&&(ot(n),Q("issuerConfirm",ae(),()=>{W(_.issuerConfirm).isNotBlank()}),Q("issuerConfirm",Zt(),()=>{W(_.issuer===_.issuerConfirm).isTruthy()}))});function wr(_,n,l){n.add(_.currentTarget.name),l()}var Sr=P('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Kr=P('<form><p> </p> <div class="mb-2"><input type="text" name="issuerConfirm"/> <!></div> <div class="flex flex-row justify-end"><button type="submit" class="btn danger flex flex-shrink"><!> </button></div></form>');function kr(_,n){Ie(n,!0);let l=u(""),p=Ir(),C=u(F(p.get())),b=u(!1),k=$(()=>e(b)),S=$(()=>ut(e(C),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const g=new Set,N=lt(()=>{p({issuer:n.issuer,issuerConfirm:e(l)},Array.from(g)).done(f=>{s(C,f,!0)}),g.clear()},300);function A(){g.add("name"),N(),N.flush()}async function K(f){f.preventDefault();try{s(b,!0),s(l,e(l).trim(),!0),A(),e(C).isValid()&&(await Le.deleteTenant(n.tenantId,n.applicationId),n.onDelete())}catch(B){await rt(B)}finally{s(b,!1)}}var m=Kr(),y=r(m),h=r(y,!0);t(y);var o=i(y,2),I=r(o);pe(I),I.__input=[wr,g,N];var M=i(I,2);re(M,{name:"issuerConfirm",get result(){return e(C)}}),t(o);var E=i(o,2),R=r(E),H=r(R);{var a=f=>{var B=Sr(),Z=r(B),V=r(Z);at(V),t(Z),t(B),j(f,B)};Ce(H,f=>{e(b)&&f(a)})}var T=i(H);t(R),t(E),t(m),G((f,B,Z,V)=>{v(h,f),ne(I,1,`w-full ${B??""}`),X(I,"placeholder",Z),R.disabled=e(k),v(T,` ${V??""}`)},[()=>Vt(),()=>e(S)("issuerConfirm"),()=>qt({issuer:n.issuer}),()=>Yt()]),tt("submit",m,K),be(I,()=>e(l),f=>s(l,f)),j(_,m),we()}He(["input"]);var Er=P('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Tr=P('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function Cr(_,n){Ie(n,!0);let l=u(!1),p=u(!1),C=$(()=>e(l)||!e(p)),b=u(F(n.tenant.algorithm)),k=u(F(n.tenant.audience)),S=u(F(n.tenant.clientId)),g=u(F(n.tenant.expiresInSeconds)),N=u(F(n.tenant.issuer)),A=u(F(n.tenant.privateKey)),K=u(F(n.tenant.publicKey)),m=u(F(n.tenant.refreshExpiresInSeconds));async function y(a){a.preventDefault();try{s(l,!0),e(p)&&n.onEdit(await Le.updateTenant(n.tenant.id,{algorithm:e(b),audience:e(k),clientId:e(S)?e(S):void 0,expiresInSeconds:e(g),issuer:e(N),privateKey:e(A)?e(A):void 0,publicKey:e(K)?e(K):void 0,refreshExpiresInSeconds:e(m)},n.applicationId))}catch(T){await rt(T)}finally{s(l,!1)}}var h=Tr(),o=r(h);vt(o,{get algorithm(){return e(b)},set algorithm(a){s(b,a,!0)},get audience(){return e(k)},set audience(a){s(k,a,!0)},get clientId(){return e(S)},set clientId(a){s(S,a,!0)},get expiresInSeconds(){return e(g)},set expiresInSeconds(a){s(g,a,!0)},get issuer(){return e(N)},set issuer(a){s(N,a,!0)},get privateKey(){return e(A)},set privateKey(a){s(A,a,!0)},get publicKey(){return e(K)},set publicKey(a){s(K,a,!0)},get refreshExpiresInSeconds(){return e(m)},set refreshExpiresInSeconds(a){s(m,a,!0)},get valid(){return e(p)},set valid(a){s(p,a,!0)}});var I=i(o,2),M=r(I),E=r(M);{var R=a=>{var T=Er(),f=r(T),B=r(f);at(B),t(f),t(T),j(a,T)};Ce(E,a=>{e(l)&&a(R)})}var H=i(E);t(M),t(I),t(h),G(a=>{M.disabled=e(C),v(H,` ${a??""}`)},[()=>zt()]),tt("submit",h,y),j(_,h),we()}const it=20;var Nr=P('<button class="btn secondary icon lg"><!></button>'),Ar=P('<a class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></a> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button>',1),jr=P('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="flex justify-end"><div class="flex flex-shrink"><!></div></td></tr>'),Br=P("<h3> </h3>"),Dr=P("<h3> </h3>"),Pr=P("<h3> </h3>"),Or=P('<table class="table-auto w-full"><thead><tr class="text-left border-b"><th> </th><th> </th><th> </th><th> </th><th> </th><th></th></tr></thead><tbody></tbody></table> <!> <!> <!>',1);function Mr(_,n){Ie(n,!0);let l=Y(n,"tenants",31,()=>F([])),p=u(0),C=u(!0),b=u(!1),k=u(void 0);gt(()=>{e(k)!==n.applicationId&&(s(k,n.applicationId,!0),s(p,0),s(C,!0),s(b,!1),l([]),S())});async function S(){if(!e(C)||e(b))return;let c;s(b,!0);try{c=await Le.allTenants(e(p)*it,it,!0,n.applicationId)}finally{s(b,!1)}s(C,c.hasMore,!0),s(p,e(p)+1),l().push(...c.items)}let g=u(!1);function N(){s(g,!0)}function A(c){l().unshift(c),s(g,!1)}let K=u(void 0),m=u(!1);function y(c){return()=>{s(K,c,!0),s(m,!0)}}function h(c){const d=l().findIndex(x=>x.id===c?.id);d!==-1&&l(l()[d]=c,!0),s(K,void 0),s(m,!1)}let o=u(void 0),I=u(!1);function M(c){return()=>{s(o,c,!0),s(I,!0)}}function E(){const c=l().findIndex(d=>d.id===e(o)?.id);c!==-1&&l().splice(c,1),s(o,void 0),s(I,!1)}function R(c){return()=>_r(`${$e}/applications/${n.applicationId}/tenants/${c.id}/oauth2-providers`)}var H=Or(),a=Te(H),T=r(a),f=r(T),B=r(f),Z=r(B,!0);t(B);var V=i(B),Fe=r(V,!0);t(V);var z=i(V),Ge=r(z,!0);t(z);var de=i(z),Se=r(de,!0);t(de);var Ne=i(de),ie=r(Ne,!0);t(Ne),yt(),t(f),t(T);var Ae=i(T);dt(Ae,23,l,c=>c.id,(c,d,x)=>{var w=jr();let D;var U=$(()=>R(e(d)));w.__click=function(...ce){e(U)?.apply(this,ce)};var L=r(w),xe=r(L,!0);t(L);var oe=i(L),Ue=r(oe,!0);t(oe);var J=i(oe),Ve=r(J,!0);t(J);var ue=i(J),Ke=r(ue,!0);t(ue);var ke=i(ue),je=r(ke,!0);t(ke);var Be=i(ke),De=r(Be),qe=r(De);sr(qe,{position:"top-right",anchorPosition:"bottom-right",button:ee=>{var se=Nr(),q=r(se);or(q,{}),t(se),j(ee,se)},children:(ee,se)=>{var q=Ar(),ge=Te(q),O=r(ge);fr(O,{});var le=i(O),Pe=r(le,!0);t(le),t(ge);var ve=i(ge,2),te=$(()=>y(e(d)));ve.__click=function(...fe){e(te)?.apply(this,fe)};var _e=r(ve);lr(_e,{});var ye=i(_e),Ye=r(ye,!0);t(ye),t(ve);var Ee=i(ve,2),Ze=$(()=>M(e(d)));Ee.__click=function(...fe){e(Ze)?.apply(this,fe)};var Oe=r(Ee);dr(Oe,{});var Me=i(Oe),ze=r(Me,!0);t(Me),t(Ee),G((fe,Je,Qe)=>{X(ge,"href",`${$e}/applications/${n.applicationId}/tenants/${e(d).id}/oauth2-providers`),v(Pe,fe),v(Ye,Je),v(ze,Qe)},[()=>ar(),()=>nr(),()=>ir()]),j(ee,q)},$$slots:{button:!0,default:!0}}),t(De),t(Be),t(w),G((ce,ee,se)=>{D=ne(w,1,"group cursor-pointer hover:bg-black/25",null,D,ce),v(xe,e(d).id),v(Ue,e(d).issuer),v(Ve,e(d).clientId),v(Ke,ee),v(je,se)},[()=>({"border-b":e(x)<l().length-1}),()=>e(d).updatedAt.toLocaleString(),()=>e(d).createdAt.toLocaleString()]),j(c,w)}),t(Ae),t(a);var me=i(a,2);Xe(me,{get open(){return e(g)},set open(d){s(g,d,!0)},title:d=>{var x=Br(),w=r(x,!0);t(x),G(D=>v(w,D),[()=>er()]),j(d,x)},children:(d,x)=>{yr(d,{get applicationId(){return n.applicationId},onCreate:A})},$$slots:{title:!0,default:!0}});var he=i(me,2);Xe(he,{get open(){return e(m)},set open(d){s(m,d,!0)},title:d=>{var x=Dr(),w=r(x,!0);t(x),G(D=>v(w,D),[()=>tr({issuer:e(K)?.issuer||""})]),j(d,x)},children:(d,x)=>{var w=nt(),D=Te(w);{var U=L=>{Cr(L,{get applicationId(){return n.applicationId},get tenant(){return e(K)},onEdit:h})};Ce(D,L=>{e(K)&&L(U)})}j(d,w)},$$slots:{title:!0,default:!0}});var Re=i(he,2);return Xe(Re,{get open(){return e(I)},set open(d){s(I,d,!0)},title:d=>{var x=Pr(),w=r(x,!0);t(x),G(D=>v(w,D),[()=>rr({issuer:e(o)?.issuer||""})]),j(d,x)},children:(d,x)=>{var w=nt(),D=Te(w);{var U=L=>{kr(L,{get applicationId(){return n.applicationId},get tenantId(){return e(o).id},get issuer(){return e(o).issuer},onDelete:E})};Ce(D,L=>{e(o)&&L(U)})}j(d,w)},$$slots:{title:!0,default:!0}}),G((c,d,x,w,D)=>{v(Z,c),v(Fe,d),v(Ge,x),v(Se,w),v(ie,D)},[()=>Jt(),()=>Qt(),()=>Wt(),()=>Xt(),()=>$t()]),j(_,H),we({onCreate:N})}He(["click"]);var Hr=P('<div class="container mx-auto"><div class="bg-white dark:bg-gray-800 shadow-lg p-4 rounded-lg m-4"><div class="flex flex-grow justify-between"><div class="flex flex-row items-center"><a class="flex flex-row items-center"><button class="btn primary icon"><!></button></a> <h3 class="m-0 ms-2"> </h3></div> <button class="btn primary icon lg"><!></button></div> <!></div></div>');function ea(_,n){Ie(n,!0);let l=u(void 0);var p=Hr();wt(o=>{G(I=>It.title=I,[()=>Kt()])});var C=r(p),b=r(C),k=r(b),S=r(k),g=r(S),N=r(g);pr(N,{}),t(g),t(S);var A=i(S,2),K=r(A,!0);t(A),t(k);var m=i(k,2);m.__click=function(...o){e(l)?.onCreate?.apply(this,o)};var y=r(m);ur(y,{}),t(m),t(b);var h=i(b,2);kt(Mr(h,{get applicationId(){return n.data.applicationId}}),o=>s(l,o,!0),()=>e(l)),t(C),t(p),G(()=>{X(S,"href",`${$e}/`),v(K,n.data.application.name)}),j(_,p),we()}He(["click"]);export{ea as component};
