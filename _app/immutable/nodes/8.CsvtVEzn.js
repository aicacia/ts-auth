import{f as O,a as D,c as tt}from"../chunks/CeYbTvSz.js";import{p as ye,F as G,b as u,f as je,s as i,c as r,g as e,G as se,t as R,a as Ie,h as s,r as t,u as gt,a7 as yt,$ as It}from"../chunks/wkzzbBdv.js";import{d as Fe,s as v,i as Ae,e as Xe,h as wt}from"../chunks/D2HIu1zJ.js";import{d as ie,b as Q,r as fe,t as St}from"../chunks/2O6vECAj.js";import{p as V,b as Kt}from"../chunks/CtNkBPER.js";import"../chunks/DgAY1fJe.js";import{b as at}from"../chunks/BiGx9tMp.js";import{G as nt,d as it,o as st,I as ae,t as Et,p as kt,q as Tt,r as Ct,s as Nt,u as jt,w as At,x as Dt,y as Pt,z as Bt,A as Ot,B as Mt,D as Ht,E as Lt,F as Ft,b as pe,m as lt,C as z,g as ne,v as J,N as Je,i as dt,H as Gt,J as Rt,j as $e,S as et,K as Ut,L as Vt,M as qt,O as Yt,P as Zt,Q as zt,R as Jt,T as Qt,U as Wt,V as Xt,W as $t,X as er,Y as tr,Z as rr,_ as ar,$ as nr}from"../chunks/CjhoWwqu.js";import{A as We,t as Ge}from"../chunks/D5kayNry.js";import{M as Qe,D as ir,P as sr,T as lr,E as dr,a as or}from"../chunks/CjJcdl5D.js";import{o as ur}from"../chunks/BlFdF53H.js";import{b as vr}from"../chunks/BVUUHFFa.js";import{P as cr}from"../chunks/ZoyK-Zui.js";import{E as _r}from"../chunks/Da4wFC0_.js";import{C as fr}from"../chunks/By5vjJJ4.js";const ot=["HS256","HS384","HS512"],pr=()=>nt((c,n)=>{n.length&&(lt(n),z("algorithm",ne(),()=>{J(c.algorithm).isNotBlank()}),Je(!c.audience,()=>{z("audience",ne(),()=>{J(c.audience).isNotBlank()})}),z("expiresInSeconds",ne(),()=>{J(c.expiresInSeconds).isNotBlank()}),z("issuer",ne(),()=>{J(c.issuer).isNotBlank()}),Je(c.isNew,()=>{z("clientId",ne(),()=>{J(c.clientId).isNotBlank()}),z("privateKey",ne(),()=>{J(c.privateKey).isNotBlank()})}),Je(ot.includes(c.algorithm),()=>{z("publicKey",ne(),()=>{J(c.publicKey).isNotBlank()})}),z("refreshExpiresInSeconds",ne(),()=>{J(c.refreshExpiresInSeconds).isNotBlank()}))});var br=O("<option> </option>"),mr=O('<div class="mb-2"><label for="algorithm"> </label> <select name="algorithm"></select> <!></div> <div class="mb-2"><label for="audience"> </label> <input type="text" name="audience"/> <!></div> <div class="mb-2"><label for="clientId"> </label> <input type="text" name="clientId"/> <!></div> <div class="mb-2"><label for="expiresInSeconds"> </label> <input type="number" min="0" name="expiresInSeconds"/> <!></div> <div class="mb-2"><label for="issuer"> </label> <input type="text" name="issuer"/> <!></div> <div class="mb-2"><label for="publicKey"> </label> <input type="text" name="publicKey"/> <!></div> <div class="mb-2"><label for="privateKey"> </label> <!> <!></div> <div class="mb-2"><label for="refreshExpiresInSeconds"> </label> <input type="number" min="0" name="refreshExpiresInSeconds"/> <!></div>',1);function ut(c,n){ye(n,!0);let d=V(n,"algorithm",31,()=>G(We.Hs256)),m=V(n,"audience",15),C=V(n,"clientId",15),h=V(n,"expiresInSeconds",15,86400),k=V(n,"issuer",15,""),S=V(n,"privateKey",15,""),I=V(n,"publicKey",15),N=V(n,"refreshExpiresInSeconds",15,604800),j=V(n,"isNew",3,!1),E=V(n,"valid",15,!1),x=pr(),w=u(G(x.get())),g=se(()=>dt(e(w),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const o=new Set,p=it(()=>{x({algorithm:d(),audience:m(),clientId:C(),expiresInSeconds:h(),issuer:k(),privateKey:S(),publicKey:I(),refreshExpiresInSeconds:N(),isNew:j()},Array.from(o)).done(F=>{s(w,F,!0),E(e(w).isValid())}),o.clear()},300);function P(){o.add("algorithm"),o.add("audience"),o.add("clientId"),o.add("expiresInSeconds"),o.add("issuer"),o.add("privateKey"),o.add("publicKey"),o.add("refreshExpiresInSeconds"),p(),p.flush()}function T(F){o.add(F.currentTarget.name),p()}ur(P);var L=mr(),H=je(L),a=r(H),A=r(a,!0);t(a);var _=i(a,2);_.__input=T,st(_,20,()=>Object.values(We),F=>F,(F,Y,Me,Ne)=>{var Z=br(),ge={},ce=r(Z,!0);t(Z),R(()=>{ge!==(ge=Y)&&(Z.value=(Z.__value=Y)??""),v(ce,Y)}),D(F,Z)}),t(_);var M=i(_,2);ae(M,{name:"algorithm",get result(){return e(w)}}),t(H);var U=i(H,2),W=r(U),we=r(W,!0);t(W);var le=i(W,2);fe(le),le.__input=T;var Se=i(le,2);ae(Se,{name:"audience",get result(){return e(w)}}),t(U);var Ke=i(U,2),be=r(Ke),Re=r(be,!0);t(be);var X=i(be,2);fe(X),X.__input=T;var De=i(X,2);ae(De,{name:"clientId",get result(){return e(w)}}),t(Ke);var me=i(Ke,2),Ee=r(me),f=r(Ee,!0);t(Ee);var l=i(Ee,2);fe(l),l.__input=T;var b=i(l,2);ae(b,{name:"expiresInSeconds",get result(){return e(w)}}),t(me);var K=i(me,2),y=r(K),$=r(y,!0);t(y);var B=i(y,2);fe(B),B.__input=T;var ke=i(B,2);ae(ke,{name:"issuer",get result(){return e(w)}}),t(K);var he=i(K,2),oe=r(he),Ue=r(oe,!0);t(oe);var q=i(oe,2);fe(q),q.__input=T;var Ve=i(q,2);ae(Ve,{name:"publicKey",get result(){return e(w)}}),t(he);var ue=i(he,2),Te=r(ue),Pe=r(Te,!0);t(Te);var Ce=i(Te,2);const qe=se(()=>e(g)("privateKey")),Be=se(()=>Gt());cr(Ce,{get class(){return`w-full ${e(qe)??""}`},name:"privateKey",get placeholder(){return e(Be)},oninput:T,get value(){return S()},set value(F){S(F)}});var ve=i(Ce,2);ae(ve,{name:"privateKey",get result(){return e(w)}}),t(ue);var ee=i(ue,2),de=r(ee),xe=r(de,!0);t(de);var te=i(de,2);fe(te),te.__input=T;var Oe=i(te,2);ae(Oe,{name:"refreshExpiresInSeconds",get result(){return e(w)}}),t(ee),R((F,Y,Me,Ne,Z,ge,ce,Ye,He,Le,Ze,_e,re,ze,vt,ct,_t,ft,pt,bt,mt,ht,xt)=>{v(A,F),ie(_,1,`w-full ${Y??""}`),Q(_,"placeholder",Me),v(we,Ne),ie(le,1,`w-full ${Z??""}`),Q(le,"placeholder",ge),v(Re,ce),ie(X,1,`w-full ${Ye??""}`),Q(X,"placeholder",He),v(f,Le),ie(l,1,`w-full ${Ze??""}`),Q(l,"placeholder",_e),v($,re),ie(B,1,`w-full ${ze??""}`),Q(B,"placeholder",vt),he.hidden=ct,v(Ue,_t),ie(q,1,`w-full ${ft??""}`),Q(q,"placeholder",pt),v(Pe,bt),v(xe,mt),ie(te,1,`w-full ${ht??""}`),Q(te,"placeholder",xt)},[()=>Et(),()=>e(g)("algorithm"),()=>kt(),()=>Tt(),()=>e(g)("audience"),()=>Ct(),()=>Nt(),()=>e(g)("clientId"),()=>jt(),()=>At(),()=>e(g)("expiresInSeconds"),()=>Dt(),()=>Pt(),()=>e(g)("issuer"),()=>Bt(),()=>ot.includes(d()),()=>Ot(),()=>e(g)("publicKey"),()=>Mt(),()=>Ht(),()=>Lt(),()=>e(g)("refreshExpiresInSeconds"),()=>Ft()]),vr(_,d),pe(le,m),pe(X,C),pe(l,h),pe(B,k),pe(q,I),pe(te,N),D(c,L),Ie()}Fe(["input"]);var hr=O('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),xr=O('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function gr(c,n){ye(n,!0);let d=u(!1),m=u(!1),C=se(()=>e(d)||!e(m)),h=u(G(We.Hs256)),k=u(""),S=u(""),I=u(86400),N=u(""),j=u(""),E=u(""),x=u(604800);async function w(a){a.preventDefault();try{s(d,!0),e(m)&&n.onCreate(await Ge.createTenant({algorithm:e(h),audience:e(k),clientId:e(S)?e(S):void 0,expiresInSeconds:e(I),issuer:e(N),privateKey:e(j)?e(j):void 0,publicKey:e(E)?e(E):void 0,refreshExpiresInSeconds:e(x)},n.applicationId))}catch(A){await $e(A)}finally{s(d,!1)}}var g=xr(),o=r(g);ut(o,{isNew:!0,get algorithm(){return e(h)},set algorithm(a){s(h,a,!0)},get audience(){return e(k)},set audience(a){s(k,a,!0)},get clientId(){return e(S)},set clientId(a){s(S,a,!0)},get expiresInSeconds(){return e(I)},set expiresInSeconds(a){s(I,a,!0)},get issuer(){return e(N)},set issuer(a){s(N,a,!0)},get privateKey(){return e(j)},set privateKey(a){s(j,a,!0)},get publicKey(){return e(E)},set publicKey(a){s(E,a,!0)},get refreshExpiresInSeconds(){return e(x)},set refreshExpiresInSeconds(a){s(x,a,!0)},get valid(){return e(m)},set valid(a){s(m,a,!0)}});var p=i(o,2),P=r(p),T=r(P);{var L=a=>{var A=hr(),_=r(A),M=r(_);et(M),t(_),t(A),D(a,A)};Ae(T,a=>{e(d)&&a(L)})}var H=i(T);t(P),t(p),t(g),R(a=>{P.disabled=e(C),v(H,` ${a??""}`)},[()=>Rt()]),Xe("submit",g,w),D(c,g),Ie()}const yr=()=>nt((c={},n)=>{n.length&&(lt(n),z("issuerConfirm",ne(),()=>{J(c.issuerConfirm).isNotBlank()}),z("issuerConfirm",Yt(),()=>{J(c.issuer===c.issuerConfirm).isTruthy()}))});function Ir(c,n,d){n.add(c.currentTarget.name),d()}var wr=O('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Sr=O('<form><p> </p> <div class="mb-2"><input type="text" name="issuerConfirm"/> <!></div> <div class="flex flex-row justify-end"><button type="submit" class="btn danger flex flex-shrink"><!> </button></div></form>');function Kr(c,n){ye(n,!0);let d=u(""),m=yr(),C=u(G(m.get())),h=u(!1),k=se(()=>e(h)),S=se(()=>dt(e(C),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const I=new Set,N=it(()=>{m({issuer:n.issuer,issuerConfirm:e(d)},Array.from(I)).done(_=>{s(C,_,!0)}),I.clear()},300);function j(){I.add("name"),N(),N.flush()}async function E(_){_.preventDefault();try{s(h,!0),s(d,e(d).trim(),!0),j(),e(C).isValid()&&(await Ge.deleteTenant(n.tenantId,n.applicationId),n.onDelete())}catch(M){await $e(M)}finally{s(h,!1)}}var x=Sr(),w=r(x),g=r(w,!0);t(w);var o=i(w,2),p=r(o);fe(p),p.__input=[Ir,I,N];var P=i(p,2);ae(P,{name:"issuerConfirm",get result(){return e(C)}}),t(o);var T=i(o,2),L=r(T),H=r(L);{var a=_=>{var M=wr(),U=r(M),W=r(U);et(W),t(U),t(M),D(_,M)};Ae(H,_=>{e(h)&&_(a)})}var A=i(H);t(L),t(T),t(x),R((_,M,U,W)=>{v(g,_),ie(p,1,`w-full ${M??""}`),Q(p,"placeholder",U),L.disabled=e(k),v(A,` ${W??""}`)},[()=>Ut(),()=>e(S)("issuerConfirm"),()=>Vt({issuer:n.issuer}),()=>qt()]),Xe("submit",x,E),pe(p,()=>e(d),_=>s(d,_)),D(c,x),Ie()}Fe(["input"]);var Er=O('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),kr=O('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function Tr(c,n){ye(n,!0);let d=u(!1),m=u(!1),C=se(()=>e(d)||!e(m)),h=u(G(n.tenant.algorithm)),k=u(G(n.tenant.audience)),S=u(G(n.tenant.clientId)),I=u(G(n.tenant.expiresInSeconds)),N=u(G(n.tenant.issuer)),j=u(G(n.tenant.privateKey)),E=u(G(n.tenant.publicKey)),x=u(G(n.tenant.refreshExpiresInSeconds));async function w(a){a.preventDefault();try{s(d,!0),e(m)&&n.onEdit(await Ge.updateTenant(n.tenant.id,{algorithm:e(h),audience:e(k),clientId:e(S)?e(S):void 0,expiresInSeconds:e(I),issuer:e(N),privateKey:e(j)?e(j):void 0,publicKey:e(E)?e(E):void 0,refreshExpiresInSeconds:e(x)},n.applicationId))}catch(A){await $e(A)}finally{s(d,!1)}}var g=kr(),o=r(g);ut(o,{get algorithm(){return e(h)},set algorithm(a){s(h,a,!0)},get audience(){return e(k)},set audience(a){s(k,a,!0)},get clientId(){return e(S)},set clientId(a){s(S,a,!0)},get expiresInSeconds(){return e(I)},set expiresInSeconds(a){s(I,a,!0)},get issuer(){return e(N)},set issuer(a){s(N,a,!0)},get privateKey(){return e(j)},set privateKey(a){s(j,a,!0)},get publicKey(){return e(E)},set publicKey(a){s(E,a,!0)},get refreshExpiresInSeconds(){return e(x)},set refreshExpiresInSeconds(a){s(x,a,!0)},get valid(){return e(m)},set valid(a){s(m,a,!0)}});var p=i(o,2),P=r(p),T=r(P);{var L=a=>{var A=Er(),_=r(A),M=r(_);et(M),t(_),t(A),D(a,A)};Ae(T,a=>{e(d)&&a(L)})}var H=i(T);t(P),t(p),t(g),R(a=>{P.disabled=e(C),v(H,` ${a??""}`)},[()=>Zt()]),Xe("submit",g,w),D(c,g),Ie()}const rt=20;var Cr=O('<button class="btn secondary icon lg"><!></button>'),Nr=O('<a class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></a> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button>',1),jr=O('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="flex justify-end"><div class="flex flex-shrink"><!></div></td></tr>'),Ar=O("<h3> </h3>"),Dr=O("<h3> </h3>"),Pr=O("<h3> </h3>"),Br=O('<table class="table-auto w-full"><thead><tr class="text-left border-b"><th> </th><th> </th><th> </th><th> </th><th> </th><th></th></tr></thead><tbody></tbody></table> <!> <!> <!>',1);function Or(c,n){ye(n,!0);let d=V(n,"tenants",31,()=>G([])),m=u(0),C=u(!0),h=u(!1),k=u(void 0);gt(()=>{e(k)!==n.applicationId&&(s(k,n.applicationId,!0),s(m,0),s(C,!0),s(h,!1),d([]),S())});async function S(){if(!e(C)||e(h))return;let f;s(h,!0);try{f=await Ge.allTenants(e(m)*rt,rt,!0,n.applicationId)}finally{s(h,!1)}s(C,f.hasMore,!0),s(m,e(m)+1),d().push(...f.items)}let I=u(!1);function N(){s(I,!0)}function j(f){d().unshift(f),s(I,!1)}let E=u(void 0),x=u(!1);function w(f){return()=>{s(E,f,!0),s(x,!0)}}function g(f){const l=d().findIndex(b=>b.id===(f==null?void 0:f.id));l!==-1&&d(d()[l]=f,!0),s(E,void 0),s(x,!1)}let o=u(void 0),p=u(!1);function P(f){return()=>{s(o,f,!0),s(p,!0)}}function T(){const f=d().findIndex(l=>{var b;return l.id===((b=e(o))==null?void 0:b.id)});f!==-1&&d().splice(f,1),s(o,void 0),s(p,!1)}var L=Br(),H=je(L),a=r(H),A=r(a),_=r(A),M=r(_,!0);t(_);var U=i(_),W=r(U,!0);t(U);var we=i(U),le=r(we,!0);t(we);var Se=i(we),Ke=r(Se,!0);t(Se);var be=i(Se),Re=r(be,!0);t(be),yt(),t(A),t(a);var X=i(a);st(X,23,d,f=>f.id,(f,l,b)=>{var K=jr();let y;var $=r(K),B=r($,!0);t($);var ke=i($),he=r(ke,!0);t(ke);var oe=i(ke),Ue=r(oe,!0);t(oe);var q=i(oe),Ve=r(q,!0);t(q);var ue=i(q),Te=r(ue,!0);t(ue);var Pe=i(ue),Ce=r(Pe),qe=r(Ce);ir(qe,{position:"top-right",anchorPosition:"bottom-right",button:ve=>{var ee=Cr(),de=r(ee);dr(de,{}),t(ee),D(ve,ee)},children:(ve,ee)=>{var de=Nr(),xe=je(de),te=r(xe);_r(te,{});var Oe=i(te),F=r(Oe,!0);t(Oe),t(xe);var Y=i(xe,2),Me=se(()=>w(e(l)));Y.__click=function(..._e){var re;(re=e(Me))==null||re.apply(this,_e)};var Ne=r(Y);sr(Ne,{});var Z=i(Ne),ge=r(Z,!0);t(Z),t(Y);var ce=i(Y,2),Ye=se(()=>P(e(l)));ce.__click=function(..._e){var re;(re=e(Ye))==null||re.apply(this,_e)};var He=r(ce);lr(He,{});var Le=i(He),Ze=r(Le,!0);t(Le),t(ce),R((_e,re,ze)=>{Q(xe,"href",`${at}/applications/${n.applicationId}/tenants/${e(l).id}/oauth2-providers`),v(F,_e),v(ge,re),v(Ze,ze)},[()=>rr(),()=>ar(),()=>nr()]),D(ve,de)},$$slots:{button:!0,default:!0}}),t(Ce),t(Pe),t(K),R((Be,ve,ee)=>{y=ie(K,1,"group",null,y,Be),v(B,e(l).id),v(he,e(l).issuer),v(Ue,e(l).clientId),v(Ve,ve),v(Te,ee)},[()=>({"border-b":e(b)<d().length-1}),()=>e(l).updatedAt.toLocaleString(),()=>e(l).createdAt.toLocaleString()]),D(f,K)}),t(X),t(H);var De=i(H,2);Qe(De,{get open(){return e(I)},set open(l){s(I,l,!0)},title:l=>{var b=Ar(),K=r(b,!0);t(b),R(y=>v(K,y),[()=>$t()]),D(l,b)},children:(l,b)=>{gr(l,{get applicationId(){return n.applicationId},onCreate:j})},$$slots:{title:!0,default:!0}});var me=i(De,2);Qe(me,{get open(){return e(x)},set open(l){s(x,l,!0)},title:l=>{var b=Dr(),K=r(b,!0);t(b),R(y=>v(K,y),[()=>{var y;return er({issuer:((y=e(E))==null?void 0:y.issuer)||""})}]),D(l,b)},children:(l,b)=>{var K=tt(),y=je(K);{var $=B=>{Tr(B,{get applicationId(){return n.applicationId},get tenant(){return e(E)},onEdit:g})};Ae(y,B=>{e(E)&&B($)})}D(l,K)},$$slots:{title:!0,default:!0}});var Ee=i(me,2);return Qe(Ee,{get open(){return e(p)},set open(l){s(p,l,!0)},title:l=>{var b=Pr(),K=r(b,!0);t(b),R(y=>v(K,y),[()=>{var y;return tr({issuer:((y=e(o))==null?void 0:y.issuer)||""})}]),D(l,b)},children:(l,b)=>{var K=tt(),y=je(K);{var $=B=>{Kr(B,{get applicationId(){return n.applicationId},get tenantId(){return e(o).id},get issuer(){return e(o).issuer},onDelete:T})};Ae(y,B=>{e(o)&&B($)})}D(l,K)},$$slots:{title:!0,default:!0}}),R((f,l,b,K,y)=>{v(M,f),v(W,l),v(le,b),v(Ke,K),v(Re,y)},[()=>zt(),()=>Jt(),()=>Qt(),()=>Wt(),()=>Xt()]),D(c,L),Ie({onCreate:N})}Fe(["click"]);var Mr=O('<div class="container mx-auto"><div class="bg-white dark:bg-gray-800 shadow-lg p-4 rounded-lg m-4"><div class="flex flex-grow justify-between"><div class="flex flex-row items-center"><a class="flex flex-row items-center"><button class="btn primary icon"><!></button></a> <h3 class="m-0 ms-2"> </h3></div> <button class="btn primary icon lg"><!></button></div> <!></div></div>');function $r(c,n){ye(n,!0);let d=u(void 0);var m=Mr();wt(o=>{R(p=>It.title=p,[()=>St()])});var C=r(m),h=r(C),k=r(h),S=r(k);Q(S,"href",`${at}/`);var I=r(S),N=r(I);fr(N,{}),t(I),t(S);var j=i(S,2),E=r(j,!0);t(j),t(k);var x=i(k,2);x.__click=function(...o){var p,P;(P=(p=e(d))==null?void 0:p.onCreate)==null||P.apply(this,o)};var w=r(x);or(w,{}),t(x),t(h);var g=i(h,2);Kt(Or(g,{get applicationId(){return n.data.applicationId}}),o=>s(d,o,!0),()=>e(d)),t(C),t(m),R(()=>v(E,n.data.application.name)),D(c,m),Ie()}Fe(["click"]);export{$r as component};
