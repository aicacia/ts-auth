import{a as B,t as H,c as it}from"../chunks/disclose-version.DrWTZEMc.js";import{T as lt,p as je,w as c,x as l,i as e,f as Ce,t as d,a as De,c as a,r as t,s,k as P,$ as ht,ad as gt}from"../chunks/runtime.BOcB0i4C.js";import{l as xt,d as $e,s as _,e as et,h as yt}from"../chunks/render.CHcgKWWy.js";import{i as Ae}from"../chunks/runtime.qIrDYYv_.js";import{d as dt,t as ot,e as Q,r as _e,s as X,b as re,$ as It,a0 as St,a1 as wt,a2 as Kt,a3 as kt,a4 as Et,a5 as Tt,a6 as Ct,a7 as Nt,a8 as At,a9 as jt,aa as Dt,ab as Pt,ac as Bt,ad as Ot,ae as Mt,af as qt,m as Ht,ag as Lt,ah as Ft,ai as Gt,aj as Rt,ak as Ut,w as Vt,al as Yt,am as Zt,an as zt,ao as Jt,ap as Qt,aq as Wt,ar as Xt,as as $t,at as ea,au as ta,av as aa}from"../chunks/debounce.DAmdUp_2.js";import{i as ra,p as u}from"../chunks/proxy.C01Lgihj.js";import{o as ut}from"../chunks/index-client.CDjIKsSM.js";import{g as na,D as ia}from"../chunks/Dropdown.CZaWqXjv.js";import{A as Xe,c as Fe}from"../chunks/index.Ch86im5p.js";import{b as sa}from"../chunks/paths.2tyyIn2U.js";import{P as la,M as Qe,a as da,T as oa,E as ua}from"../chunks/Modal.J4_VPY9n.js";import{I as W,b as fe,G as vt,m as ct,C as Y,v as Z,N as We,a as _t,S as tt,h as at}from"../chunks/InputResults.BQnRkFhZ.js";import{p as V}from"../chunks/props.D-n0bGyQ.js";import{P as va}from"../chunks/Password.Db4C1CHT.js";import{C as ca}from"../chunks/chevron-left.BWoKH1Cg.js";function ft(i,r,o){if(i.multiple)return pa(i,r);for(var f of i.options){var b=Ne(f);if(ra(b,r)){f.selected=!0;return}}(!o||r!==void 0)&&(i.selectedIndex=-1)}function _a(i,r){lt(()=>{var o=new MutationObserver(()=>{var f=i.__value;ft(i,f)});return o.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{o.disconnect()}})}function fa(i,r,o=r){var f=!0;xt(i,"change",b=>{var h=b?"[selected]":":checked",S;if(i.multiple)S=[].map.call(i.querySelectorAll(h),Ne);else{var K=i.querySelector(h)??i.querySelector("option:not([disabled])");S=K&&Ne(K)}o(S)}),lt(()=>{var b=r();if(ft(i,b,f),f&&b===void 0){var h=i.querySelector(":checked");h!==null&&(b=Ne(h),o(b))}i.__value=b,f=!1}),_a(i)}function pa(i,r){for(var o of i.options)o.selected=~r.indexOf(Ne(o))}function Ne(i){return"__value"in i?i.__value:i.value}const pt=["HS256","HS384","HS512"],ba=()=>vt((i,r)=>{r.length&&(ct(r),Y("algorithm",Q(),()=>{Z(i.algorithm).isNotBlank()}),We(!i.audience,()=>{Y("audience",Q(),()=>{Z(i.audience).isNotBlank()})}),Y("expiresInSeconds",Q(),()=>{Z(i.expiresInSeconds).isNotBlank()}),Y("issuer",Q(),()=>{Z(i.issuer).isNotBlank()}),We(i.isNew,()=>{Y("clientId",Q(),()=>{Z(i.clientId).isNotBlank()}),Y("privateKey",Q(),()=>{Z(i.privateKey).isNotBlank()})}),We(pt.includes(i.algorithm),()=>{Y("publicKey",Q(),()=>{Z(i.publicKey).isNotBlank()})}),Y("refreshExpiresInSeconds",Q(),()=>{Z(i.refreshExpiresInSeconds).isNotBlank()}))});var ma=H("<option> </option>"),ha=H('<div class="mb-2"><label for="algorithm"> </label> <select name="algorithm"></select> <!></div> <div class="mb-2"><label for="audience"> </label> <input type="text" name="audience"> <!></div> <div class="mb-2"><label for="clientId"> </label> <input type="text" name="clientId"> <!></div> <div class="mb-2"><label for="expiresInSeconds"> </label> <input type="number" min="0" name="expiresInSeconds"> <!></div> <div class="mb-2"><label for="issuer"> </label> <input type="text" name="issuer"> <!></div> <div class="mb-2"><label for="publicKey"> </label> <input type="text" name="publicKey"> <!></div> <div class="mb-2"><label for="privateKey"> </label> <!> <!></div> <div class="mb-2"><label for="refreshExpiresInSeconds"> </label> <input type="number" min="0" name="refreshExpiresInSeconds"> <!></div>',1);function bt(i,r){je(r,!0);let o=V(r,"algorithm",31,()=>u(Xe.Hs256)),f=V(r,"audience",15),b=V(r,"clientId",15),h=V(r,"expiresInSeconds",15,86400),S=V(r,"issuer",15,""),K=V(r,"privateKey",15,""),w=V(r,"publicKey",15),E=V(r,"refreshExpiresInSeconds",15,604800),O=V(r,"isNew",3,!1),M=V(r,"valid",15,!1),g=ba(),m=c(u(g.get())),I=P(()=>_t(e(m),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const x=new Set,N=dt(()=>{g({algorithm:o(),audience:f(),clientId:b(),expiresInSeconds:h(),issuer:S(),privateKey:K(),publicKey:w(),refreshExpiresInSeconds:E(),isNew:O()},Array.from(x)).done(R=>{l(m,u(R)),M(e(m).isValid())}),x.clear()},300);function L(){x.add("algorithm"),x.add("audience"),x.add("clientId"),x.add("expiresInSeconds"),x.add("issuer"),x.add("privateKey"),x.add("publicKey"),x.add("refreshExpiresInSeconds"),N(),N.flush()}function D(R){x.add(R.currentTarget.name),N()}ut(L);var G=ha(),q=Ce(G),n=a(q),T=a(n,!0);d(()=>_(T,Nt())),t(n);var k=s(n,2);const C=P(()=>`w-full ${e(I)("algorithm")??""}`);d(()=>X(k,"placeholder",It())),k.__input=D,ot(k,20,()=>Object.values(Xe),R=>R,(R,ve)=>{var ce=ma(),he={},ze=a(ce,!0);t(ce),d(()=>{he!==(he=ve)&&(ce.value=(ce.__value=ve)==null?"":ve),_(ze,ve)}),B(R,ce)}),t(k);var ne=s(k,2);W(ne,{name:"algorithm",get result(){return e(m)}}),t(q);var ie=s(q,2),se=a(ie),Ge=a(se,!0);d(()=>_(Ge,At())),t(se);var z=s(se,2);_e(z);const ge=P(()=>`w-full ${e(I)("audience")??""}`);d(()=>X(z,"placeholder",St())),z.__input=D;var Pe=s(z,2);W(Pe,{name:"audience",get result(){return e(m)}}),t(ie);var le=s(ie,2),xe=a(le),ye=a(xe,!0);d(()=>_(ye,jt())),t(xe);var ee=s(xe,2);_e(ee);const Ie=P(()=>`w-full ${e(I)("clientId")??""}`);d(()=>X(ee,"placeholder",wt())),ee.__input=D;var Re=s(ee,2);W(Re,{name:"clientId",get result(){return e(m)}}),t(le);var de=s(le,2),Se=a(de),Be=a(Se,!0);d(()=>_(Be,Dt())),t(Se);var te=s(Se,2);_e(te);const Oe=P(()=>`w-full ${e(I)("expiresInSeconds")??""}`);d(()=>X(te,"placeholder",Kt())),te.__input=D;var Me=s(te,2);W(Me,{name:"expiresInSeconds",get result(){return e(m)}}),t(de);var pe=s(de,2),we=a(pe),p=a(we,!0);d(()=>_(p,Pt())),t(we);var v=s(we,2);_e(v);const y=P(()=>`w-full ${e(I)("issuer")??""}`);d(()=>X(v,"placeholder",kt())),v.__input=D;var A=s(v,2);W(A,{name:"issuer",get result(){return e(m)}}),t(pe);var j=s(pe,2);d(()=>j.hidden=pt.includes(o()));var J=a(j),F=a(J,!0);d(()=>_(F,Bt())),t(J);var ae=s(J,2);_e(ae);const Ke=P(()=>`w-full ${e(I)("publicKey")??""}`);d(()=>X(ae,"placeholder",Et())),ae.__input=D;var Ue=s(ae,2);W(Ue,{name:"publicKey",get result(){return e(m)}}),t(j);var oe=s(j,2),ke=a(oe),Ee=a(ke,!0);d(()=>_(Ee,Ot())),t(ke);var qe=s(ke,2),He=P(()=>`w-full ${e(I)("privateKey")??""}`),Le=P(()=>Tt());va(qe,{get class(){return e(He)},name:"privateKey",get placeholder(){return e(Le)},oninput:D,get value(){return K()},set value(R){K(R)}});var Ve=s(qe,2);W(Ve,{name:"privateKey",get result(){return e(m)}}),t(oe);var Ye=s(oe,2),ue=a(Ye),be=a(ue,!0);d(()=>_(be,Mt())),t(ue);var U=s(ue,2);_e(U);const me=P(()=>`w-full ${e(I)("refreshExpiresInSeconds")??""}`);d(()=>X(U,"placeholder",Ct())),U.__input=D;var Ze=s(U,2);W(Ze,{name:"refreshExpiresInSeconds",get result(){return e(m)}}),t(Ye),d(()=>{re(k,e(C)),re(z,e(ge)),re(ee,e(Ie)),re(te,e(Oe)),re(v,e(y)),re(ae,e(Ke)),re(U,e(me))}),fa(k,o),fe(z,f),fe(ee,b),fe(te,h),fe(v,S),fe(ae,w),fe(U,E),B(i,G),De()}$e(["input"]);var ga=H('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),xa=H('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function ya(i,r){je(r,!0);let o=c(!1),f=c(!1),b=P(()=>e(o)||!e(f)),h=c(u(Xe.Hs256)),S=c(""),K=c(""),w=c(86400),E=c(""),O=c(""),M=c(""),g=c(604800);async function m(n){n.preventDefault();try{l(o,!0),e(f)&&r.onCreate(await Fe.createTenant({algorithm:e(h),audience:e(S),clientId:e(K)?e(K):void 0,expiresInSeconds:e(w),issuer:e(E),privateKey:e(O)?e(O):void 0,publicKey:e(M)?e(M):void 0,refreshExpiresInSeconds:e(g)},r.applicationId))}catch(T){await at(T)}finally{l(o,!1)}}var I=xa(),x=a(I);bt(x,{isNew:!0,get algorithm(){return e(h)},set algorithm(n){l(h,u(n))},get audience(){return e(S)},set audience(n){l(S,u(n))},get clientId(){return e(K)},set clientId(n){l(K,u(n))},get expiresInSeconds(){return e(w)},set expiresInSeconds(n){l(w,u(n))},get issuer(){return e(E)},set issuer(n){l(E,u(n))},get privateKey(){return e(O)},set privateKey(n){l(O,u(n))},get publicKey(){return e(M)},set publicKey(n){l(M,u(n))},get refreshExpiresInSeconds(){return e(g)},set refreshExpiresInSeconds(n){l(g,u(n))},get valid(){return e(f)},set valid(n){l(f,u(n))}});var N=s(x,2),L=a(N),D=a(L);{var G=n=>{var T=ga(),k=a(T),C=a(k);tt(C),t(k),t(T),B(n,T)};Ae(D,n=>{e(o)&&n(G)})}var q=s(D);d(()=>_(q,` ${qt()??""}`)),t(L),t(N),t(I),d(()=>L.disabled=e(b)),et("submit",I,m),B(i,I),De()}const Ia=()=>vt((i={},r)=>{r.length&&(ct(r),Y("issuerConfirm",Q(),()=>{Z(i.issuerConfirm).isNotBlank()}),Y("issuerConfirm",Ht(),()=>{Z(i.issuer===i.issuerConfirm).isTruthy()}))});function Sa(i,r,o){r.add(i.currentTarget.name),o()}var wa=H('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Ka=H('<form><p> </p> <div class="mb-2"><input type="text" name="issuerConfirm"> <!></div> <div class="flex flex-row justify-end"><button type="submit" class="btn danger flex flex-shrink"><!> </button></div></form>');function ka(i,r){je(r,!0);let o=c(""),f=Ia(),b=c(u(f.get())),h=c(!1),S=P(()=>e(h)),K=P(()=>_t(e(b),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const w=new Set,E=dt(()=>{f({issuer:r.issuer,issuerConfirm:e(o)},Array.from(w)).done(C=>{l(b,u(C))}),w.clear()},300);function O(){w.add("name"),E(),E.flush()}async function M(C){C.preventDefault();try{l(h,!0),l(o,u(e(o).trim())),O(),e(b).isValid()&&(await Fe.deleteTenant(r.tenantId,r.applicationId),r.onDelete())}catch($){await at($)}finally{l(h,!1)}}var g=Ka(),m=a(g),I=a(m,!0);d(()=>_(I,Ft())),t(m);var x=s(m,2),N=a(x);_e(N);const L=P(()=>`w-full ${e(K)("issuerConfirm")??""}`);d(()=>X(N,"placeholder",Lt({issuer:r.issuer}))),N.__input=[Sa,w,E];var D=s(N,2);W(D,{name:"issuerConfirm",get result(){return e(b)}}),t(x);var G=s(x,2),q=a(G),n=a(q);{var T=C=>{var $=wa(),ne=a($),ie=a(ne);tt(ie),t(ne),t($),B(C,$)};Ae(n,C=>{e(h)&&C(T)})}var k=s(n);d(()=>_(k,` ${Gt()??""}`)),t(q),t(G),t(g),d(()=>{re(N,e(L)),q.disabled=e(S)}),et("submit",g,M),fe(N,()=>e(o),C=>l(o,C)),B(i,g),De()}$e(["input"]);var Ea=H('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Ta=H('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function Ca(i,r){je(r,!0);let o=c(!1),f=c(!1),b=P(()=>e(o)||!e(f)),h=c(u(r.tenant.algorithm)),S=c(u(r.tenant.audience)),K=c(u(r.tenant.clientId)),w=c(u(r.tenant.expiresInSeconds)),E=c(u(r.tenant.issuer)),O=c(u(r.tenant.privateKey)),M=c(u(r.tenant.publicKey)),g=c(u(r.tenant.refreshExpiresInSeconds));async function m(n){n.preventDefault();try{l(o,!0),e(f)&&r.onEdit(await Fe.updateTenant(r.tenant.id,{algorithm:e(h),audience:e(S),clientId:e(K)?e(K):void 0,expiresInSeconds:e(w),issuer:e(E),privateKey:e(O)?e(O):void 0,publicKey:e(M)?e(M):void 0,refreshExpiresInSeconds:e(g)},r.applicationId))}catch(T){await at(T)}finally{l(o,!1)}}var I=Ta(),x=a(I);bt(x,{get algorithm(){return e(h)},set algorithm(n){l(h,u(n))},get audience(){return e(S)},set audience(n){l(S,u(n))},get clientId(){return e(K)},set clientId(n){l(K,u(n))},get expiresInSeconds(){return e(w)},set expiresInSeconds(n){l(w,u(n))},get issuer(){return e(E)},set issuer(n){l(E,u(n))},get privateKey(){return e(O)},set privateKey(n){l(O,u(n))},get publicKey(){return e(M)},set publicKey(n){l(M,u(n))},get refreshExpiresInSeconds(){return e(g)},set refreshExpiresInSeconds(n){l(g,u(n))},get valid(){return e(f)},set valid(n){l(f,u(n))}});var N=s(x,2),L=a(N),D=a(L);{var G=n=>{var T=Ea(),k=a(T),C=a(k);tt(C),t(k),t(T),B(n,T)};Ae(D,n=>{e(o)&&n(G)})}var q=s(D);d(()=>_(q,` ${Rt()??""}`)),t(L),t(N),t(I),d(()=>L.disabled=e(b)),et("submit",I,m),B(i,I),De()}const st=20;function Na(i,r){l(r,!0)}var Aa=H('<button class="btn secondary icon lg"><!></button>'),ja=H('<button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button>',1),Da=H('<tr class="group"><td> </td><td> </td><td> </td><td> </td><td> </td><td class="flex justify-end"><div class="flex flex-shrink"><!></div></td></tr>'),Pa=H("<h3> </h3>"),Ba=H("<h3> </h3>"),Oa=H("<h3> </h3>"),Ma=H('<div class="container mx-auto my-4"><div class="bg-white dark:bg-gray-800 shadow-lg p-4 rounded-lg"><div class="flex flex-grow justify-between"><a class="flex flex-row items-center"><button class="btn primary icon"><!></button> <span class="ms-2"> </span></a> <button class="btn primary icon lg"><!></button></div> <table class="table-auto w-full"><thead><tr class="text-left border-b"><th> </th><th> </th><th> </th><th> </th><th> </th><th></th></tr></thead><tbody></tbody></table></div></div> <!> <!> <!>',1);function $a(i,r){je(r,!0);let o=u([]),f=c(0),b=c(!0);ut(h);async function h(){if(!e(b))return;const p=await Fe.allTenants(e(f)*st,st,!0,r.data.applicationId);l(b,u(p.hasMore)),l(f,e(f)+1),o.push(...p.items)}let S=c(!1);function K(p){o.unshift(p),l(S,!1)}let w=c(void 0),E=c(!1);function O(p){return()=>{l(w,u(p)),l(E,!0)}}function M(p){const v=o.findIndex(y=>y.id===(p==null?void 0:p.id));v!==-1&&(o[v]=p),l(w,void 0),l(E,!1)}let g=c(void 0),m=c(!1);function I(p){return()=>{l(g,u(p)),l(m,!0)}}function x(){const p=o.findIndex(v=>{var y;return v.id===((y=e(g))==null?void 0:y.id)});p!==-1&&o.splice(p,1),l(g,void 0),l(m,!1)}const N=na(),[L,D]=N;var G=Ma();yt(p=>{d(()=>ht.title=Ut())});var q=Ce(G),n=a(q),T=a(n),k=a(T);d(()=>X(k,"href",L(`${sa}/`,void 0)));var C=a(k),$=a(C);ca($,{}),t(C);var ne=s(C,2),ie=a(ne,!0);d(()=>_(ie,zt())),t(ne),t(k);var se=s(k,2);se.__click=[Na,S];var Ge=a(se);la(Ge,{}),t(se),t(T);var z=s(T,2),ge=a(z),Pe=a(ge),le=a(Pe),xe=a(le,!0);d(()=>_(xe,Jt())),t(le);var ye=s(le),ee=a(ye,!0);d(()=>_(ee,Qt())),t(ye);var Ie=s(ye),Re=a(Ie,!0);d(()=>_(Re,Wt())),t(Ie);var de=s(Ie),Se=a(de,!0);d(()=>_(Se,Xt())),t(de);var Be=s(de),te=a(Be,!0);d(()=>_(te,$t())),t(Be),gt(),t(Pe),t(ge);var Oe=s(ge);ot(Oe,23,()=>o,p=>p.id,(p,v,y)=>{var A=Da(),j=a(A),J=a(j,!0);t(j);var F=s(j),ae=a(F,!0);t(F);var Ke=s(F),Ue=a(Ke,!0);t(Ke);var oe=s(Ke),ke=a(oe,!0);d(()=>_(ke,e(v).updatedAt.toLocaleString())),t(oe);var Ee=s(oe),qe=a(Ee,!0);d(()=>_(qe,e(v).createdAt.toLocaleString())),t(Ee);var He=s(Ee),Le=a(He),Ve=a(Le);ia(Ve,{position:"top-right",anchorPosition:"bottom-right",button:ue=>{var be=Aa(),U=a(be);ua(U,{}),t(be),B(ue,be)},children:(ue,be)=>{var U=ja(),me=Ce(U),Ze=P(()=>O(e(v)));me.__click=function(...Je){var Te;(Te=e(Ze))==null||Te.apply(this,Je)};var R=a(me);da(R,{});var ve=s(R),ce=a(ve,!0);d(()=>_(ce,ea())),t(ve),t(me);var he=s(me,2),ze=P(()=>I(e(v)));he.__click=function(...Je){var Te;(Te=e(ze))==null||Te.apply(this,Je)};var rt=a(he);oa(rt,{});var nt=s(rt),mt=a(nt,!0);d(()=>_(mt,ta())),t(nt),t(he),B(ue,U)},$$slots:{button:!0,default:!0}}),t(Le),t(He),t(A),d(()=>{Vt(A,"border-b",e(y)<o.length-1),_(J,e(v).id),_(ae,e(v).issuer),_(Ue,e(v).clientId)}),B(p,A)}),t(Oe),t(z),t(n),t(q);var Me=s(q,2);Qe(Me,{get open(){return e(S)},set open(v){l(S,u(v))},title:v=>{var y=Pa(),A=a(y,!0);d(()=>_(A,aa())),t(y),B(v,y)},children:(v,y)=>{ya(v,{get applicationId(){return r.data.applicationId},onCreate:K})},$$slots:{title:!0,default:!0}});var pe=s(Me,2);Qe(pe,{get open(){return e(E)},set open(v){l(E,u(v))},title:v=>{var y=Ba(),A=a(y,!0);d(()=>{var j;return _(A,Yt({issuer:((j=e(w))==null?void 0:j.issuer)||""}))}),t(y),B(v,y)},children:(v,y)=>{var A=it(),j=Ce(A);{var J=F=>{Ca(F,{get applicationId(){return r.data.applicationId},get tenant(){return e(w)},onEdit:M})};Ae(j,F=>{e(w)&&F(J)})}B(v,A)},$$slots:{title:!0,default:!0}});var we=s(pe,2);Qe(we,{get open(){return e(m)},set open(v){l(m,u(v))},title:v=>{var y=Oa(),A=a(y,!0);d(()=>{var j;return _(A,Zt({issuer:((j=e(g))==null?void 0:j.issuer)||""}))}),t(y),B(v,y)},children:(v,y)=>{var A=it(),j=Ce(A);{var J=F=>{ka(F,{get applicationId(){return r.data.applicationId},get tenantId(){return e(g).id},get issuer(){return e(g).issuer},onDelete:x})};Ae(j,F=>{e(g)&&F(J)})}B(v,A)},$$slots:{title:!0,default:!0}}),B(i,G),De()}$e(["click"]);export{$a as component};
