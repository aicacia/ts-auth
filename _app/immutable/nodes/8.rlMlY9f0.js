import{a as O,t as q,c as at}from"../chunks/disclose-version.DAXeEFki.js";import{T as nt,p as me,w as c,x as d,i as e,f as Ae,t as o,a as he,c as a,r as t,s,k as M,ah as bt,$ as mt}from"../chunks/runtime.Dxz2USVk.js";import{l as ht,d as Le,s as p,e as Je,h as gt}from"../chunks/render.BT-HGqxZ.js";import{d as it,u as st,e as $,r as ce,s as z,b as se,ah as xt,ai as yt,aj as It,ak as St,al as wt,am as kt,an as Kt,ao as Et,ap as Tt,aq as Ct,ar as Nt,as as At,at as jt,au as Dt,av as Pt,aw as Bt,ax as Ot,n as Mt,ay as qt,az as Ft,aA as Ht,aB as Lt,v as Gt,P as Vt,Q as Rt,aC as Ut,aD as Yt,aE as Zt,aF as zt,aG as Qt,V as Wt,W as Xt,X as Jt,Y as $t,Z as ea,_ as ta}from"../chunks/debounce.ZLRl6Ahz.js";import{i as aa,p as u}from"../chunks/proxy.wnGPLs2U.js";import{p as R,b as ra}from"../chunks/props.VGTkXN6c.js";import{g as lt,D as na}from"../chunks/Dropdown.deJfGaB5.js";import{b as dt}from"../chunks/paths.DxZnsL0E.js";import{i as De}from"../chunks/runtime.CpXx6LBu.js";import{o as ot}from"../chunks/index-client.ClaMtOFT.js";import{A as Xe,t as Ge}from"../chunks/index.Bg6CL-Uu.js";import{M as Qe,P as ia,T as sa,E as la,a as da}from"../chunks/Modal.Djv8yqq0.js";import{I as ee,b as _e,G as ut,m as vt,C as Y,v as Z,N as We,a as ct,S as $e,h as et}from"../chunks/InputResults.BZck2DBY.js";import{P as oa}from"../chunks/Password.CpreWW2i.js";import{E as ua}from"../chunks/external-link.D1WqY_YN.js";import{C as va}from"../chunks/chevron-left.Bu43mO8U.js";function _t(i,r,l){if(i.multiple)return fa(i,r);for(var f of i.options){var h=je(f);if(aa(h,r)){f.selected=!0;return}}(!l||r!==void 0)&&(i.selectedIndex=-1)}function ca(i,r){nt(()=>{var l=new MutationObserver(()=>{var f=i.__value;_t(i,f)});return l.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{l.disconnect()}})}function _a(i,r,l=r){var f=!0;ht(i,"change",h=>{var g=h?"[selected]":":checked",k;if(i.multiple)k=[].map.call(i.querySelectorAll(g),je);else{var x=i.querySelector(g)??i.querySelector("option:not([disabled])");k=x&&je(x)}l(k)}),nt(()=>{var h=r();if(_t(i,h,f),f&&h===void 0){var g=i.querySelector(":checked");g!==null&&(h=je(g),l(h))}i.__value=h,f=!1}),ca(i)}function fa(i,r){for(var l of i.options)l.selected=~r.indexOf(je(l))}function je(i){return"__value"in i?i.__value:i.value}const ft=["HS256","HS384","HS512"],pa=()=>ut((i,r)=>{r.length&&(vt(r),Y("algorithm",$(),()=>{Z(i.algorithm).isNotBlank()}),We(!i.audience,()=>{Y("audience",$(),()=>{Z(i.audience).isNotBlank()})}),Y("expiresInSeconds",$(),()=>{Z(i.expiresInSeconds).isNotBlank()}),Y("issuer",$(),()=>{Z(i.issuer).isNotBlank()}),We(i.isNew,()=>{Y("clientId",$(),()=>{Z(i.clientId).isNotBlank()}),Y("privateKey",$(),()=>{Z(i.privateKey).isNotBlank()})}),We(ft.includes(i.algorithm),()=>{Y("publicKey",$(),()=>{Z(i.publicKey).isNotBlank()})}),Y("refreshExpiresInSeconds",$(),()=>{Z(i.refreshExpiresInSeconds).isNotBlank()}))});var ba=q("<option> </option>"),ma=q('<div class="mb-2"><label for="algorithm"> </label> <select name="algorithm"></select> <!></div> <div class="mb-2"><label for="audience"> </label> <input type="text" name="audience"> <!></div> <div class="mb-2"><label for="clientId"> </label> <input type="text" name="clientId"> <!></div> <div class="mb-2"><label for="expiresInSeconds"> </label> <input type="number" min="0" name="expiresInSeconds"> <!></div> <div class="mb-2"><label for="issuer"> </label> <input type="text" name="issuer"> <!></div> <div class="mb-2"><label for="publicKey"> </label> <input type="text" name="publicKey"> <!></div> <div class="mb-2"><label for="privateKey"> </label> <!> <!></div> <div class="mb-2"><label for="refreshExpiresInSeconds"> </label> <input type="number" min="0" name="refreshExpiresInSeconds"> <!></div>',1);function pt(i,r){me(r,!0);let l=R(r,"algorithm",31,()=>u(Xe.Hs256)),f=R(r,"audience",15),h=R(r,"clientId",15),g=R(r,"expiresInSeconds",15,86400),k=R(r,"issuer",15,""),x=R(r,"privateKey",15,""),K=R(r,"publicKey",15),E=R(r,"refreshExpiresInSeconds",15,604800),y=R(r,"isNew",3,!1),C=R(r,"valid",15,!1),N=pa(),I=c(u(N.get())),_=M(()=>ct(e(I),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const b=new Set,A=it(()=>{N({algorithm:l(),audience:f(),clientId:h(),expiresInSeconds:g(),issuer:k(),privateKey:x(),publicKey:K(),refreshExpiresInSeconds:E(),isNew:y()},Array.from(b)).done(V=>{d(I,u(V)),C(e(I).isValid())}),b.clear()},300);function P(){b.add("algorithm"),b.add("audience"),b.add("clientId"),b.add("expiresInSeconds"),b.add("issuer"),b.add("privateKey"),b.add("publicKey"),b.add("refreshExpiresInSeconds"),A(),A.flush()}function T(V){b.add(V.currentTarget.name),A()}ot(P);var L=ma(),G=Ae(L),n=a(G),j=a(n,!0);o(()=>p(j,Tt())),t(n);var D=s(n,2);const B=M(()=>`w-full ${e(_)("algorithm")??""}`);o(()=>z(D,"placeholder",xt())),D.__input=T,st(D,20,()=>Object.values(Xe),V=>V,(V,ve)=>{var ie=ba(),He={},Ce=a(ie,!0);t(ie),o(()=>{He!==(He=ve)&&(ie.value=(ie.__value=ve)==null?"":ve),p(Ce,ve)}),O(V,ie)}),t(D);var fe=s(D,2);ee(fe,{name:"algorithm",get result(){return e(I)}}),t(G);var Q=s(G,2),ge=a(Q),xe=a(ge,!0);o(()=>p(xe,Ct())),t(ge);var te=s(ge,2);ce(te);const ye=M(()=>`w-full ${e(_)("audience")??""}`);o(()=>z(te,"placeholder",yt())),te.__input=T;var Ve=s(te,2);ee(Ve,{name:"audience",get result(){return e(I)}}),t(Q);var pe=s(Q,2),Ie=a(pe),Pe=a(Ie,!0);o(()=>p(Pe,Nt())),t(Ie);var W=s(Ie,2);ce(W);const Be=M(()=>`w-full ${e(_)("clientId")??""}`);o(()=>z(W,"placeholder",It())),W.__input=T;var Re=s(W,2);ee(Re,{name:"clientId",get result(){return e(I)}}),t(pe);var m=s(pe,2),v=a(m),S=a(v,!0);o(()=>p(S,At())),t(v);var w=s(v,2);ce(w);const F=M(()=>`w-full ${e(_)("expiresInSeconds")??""}`);o(()=>z(w,"placeholder",St())),w.__input=T;var le=s(w,2);ee(le,{name:"expiresInSeconds",get result(){return e(I)}}),t(m);var H=s(m,2),Se=a(H),we=a(Se,!0);o(()=>p(we,jt())),t(Se);var ae=s(Se,2);ce(ae);const ke=M(()=>`w-full ${e(_)("issuer")??""}`);o(()=>z(ae,"placeholder",wt())),ae.__input=T;var Ue=s(ae,2);ee(Ue,{name:"issuer",get result(){return e(I)}}),t(H);var re=s(H,2);o(()=>re.hidden=ft.includes(l()));var Ke=a(re),Oe=a(Ke,!0);o(()=>p(Oe,Dt())),t(Ke);var X=s(Ke,2);ce(X);const Ye=M(()=>`w-full ${e(_)("publicKey")??""}`);o(()=>z(X,"placeholder",kt())),X.__input=T;var tt=s(X,2);ee(tt,{name:"publicKey",get result(){return e(I)}}),t(re);var de=s(re,2),ne=a(de),be=a(ne,!0);o(()=>p(be,Pt())),t(ne);var oe=s(ne,2),Me=M(()=>`w-full ${e(_)("privateKey")??""}`),qe=M(()=>Kt());oa(oe,{get class(){return e(Me)},name:"privateKey",get placeholder(){return e(qe)},oninput:T,get value(){return x()},set value(V){x(V)}});var Ze=s(oe,2);ee(Ze,{name:"privateKey",get result(){return e(I)}}),t(de);var ue=s(de,2),Ee=a(ue),Fe=a(Ee,!0);o(()=>p(Fe,Bt())),t(Ee);var J=s(Ee,2);ce(J);const ze=M(()=>`w-full ${e(_)("refreshExpiresInSeconds")??""}`);o(()=>z(J,"placeholder",Et())),J.__input=T;var Te=s(J,2);ee(Te,{name:"refreshExpiresInSeconds",get result(){return e(I)}}),t(ue),o(()=>{se(D,e(B)),se(te,e(ye)),se(W,e(Be)),se(w,e(F)),se(ae,e(ke)),se(X,e(Ye)),se(J,e(ze))}),_a(D,l),_e(te,f),_e(W,h),_e(w,g),_e(ae,k),_e(X,K),_e(J,E),O(i,L),he()}Le(["input"]);var ha=q('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),ga=q('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function xa(i,r){me(r,!0);let l=c(!1),f=c(!1),h=M(()=>e(l)||!e(f)),g=c(u(Xe.Hs256)),k=c(""),x=c(""),K=c(86400),E=c(""),y=c(""),C=c(""),N=c(604800);async function I(n){n.preventDefault();try{d(l,!0),e(f)&&r.onCreate(await Ge.createTenant({algorithm:e(g),audience:e(k),clientId:e(x)?e(x):void 0,expiresInSeconds:e(K),issuer:e(E),privateKey:e(y)?e(y):void 0,publicKey:e(C)?e(C):void 0,refreshExpiresInSeconds:e(N)},r.applicationId))}catch(j){await et(j)}finally{d(l,!1)}}var _=ga(),b=a(_);pt(b,{isNew:!0,get algorithm(){return e(g)},set algorithm(n){d(g,u(n))},get audience(){return e(k)},set audience(n){d(k,u(n))},get clientId(){return e(x)},set clientId(n){d(x,u(n))},get expiresInSeconds(){return e(K)},set expiresInSeconds(n){d(K,u(n))},get issuer(){return e(E)},set issuer(n){d(E,u(n))},get privateKey(){return e(y)},set privateKey(n){d(y,u(n))},get publicKey(){return e(C)},set publicKey(n){d(C,u(n))},get refreshExpiresInSeconds(){return e(N)},set refreshExpiresInSeconds(n){d(N,u(n))},get valid(){return e(f)},set valid(n){d(f,u(n))}});var A=s(b,2),P=a(A),T=a(P);{var L=n=>{var j=ha(),D=a(j),B=a(D);$e(B),t(D),t(j),O(n,j)};De(T,n=>{e(l)&&n(L)})}var G=s(T);o(()=>p(G,` ${Ot()??""}`)),t(P),t(A),t(_),o(()=>P.disabled=e(h)),Je("submit",_,I),O(i,_),he()}const ya=()=>ut((i={},r)=>{r.length&&(vt(r),Y("issuerConfirm",$(),()=>{Z(i.issuerConfirm).isNotBlank()}),Y("issuerConfirm",Mt(),()=>{Z(i.issuer===i.issuerConfirm).isTruthy()}))});function Ia(i,r,l){r.add(i.currentTarget.name),l()}var Sa=q('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),wa=q('<form><p> </p> <div class="mb-2"><input type="text" name="issuerConfirm"> <!></div> <div class="flex flex-row justify-end"><button type="submit" class="btn danger flex flex-shrink"><!> </button></div></form>');function ka(i,r){me(r,!0);let l=c(""),f=ya(),h=c(u(f.get())),g=c(!1),k=M(()=>e(g)),x=M(()=>ct(e(h),{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}));const K=new Set,E=it(()=>{f({issuer:r.issuer,issuerConfirm:e(l)},Array.from(K)).done(B=>{d(h,u(B))}),K.clear()},300);function y(){K.add("name"),E(),E.flush()}async function C(B){B.preventDefault();try{d(g,!0),d(l,u(e(l).trim())),y(),e(h).isValid()&&(await Ge.deleteTenant(r.tenantId,r.applicationId),r.onDelete())}catch(U){await et(U)}finally{d(g,!1)}}var N=wa(),I=a(N),_=a(I,!0);o(()=>p(_,Ft())),t(I);var b=s(I,2),A=a(b);ce(A);const P=M(()=>`w-full ${e(x)("issuerConfirm")??""}`);o(()=>z(A,"placeholder",qt({issuer:r.issuer}))),A.__input=[Ia,K,E];var T=s(A,2);ee(T,{name:"issuerConfirm",get result(){return e(h)}}),t(b);var L=s(b,2),G=a(L),n=a(G);{var j=B=>{var U=Sa(),fe=a(U),Q=a(fe);$e(Q),t(fe),t(U),O(B,U)};De(n,B=>{e(g)&&B(j)})}var D=s(n);o(()=>p(D,` ${Ht()??""}`)),t(G),t(L),t(N),o(()=>{se(A,e(P)),G.disabled=e(k)}),Je("submit",N,C),_e(A,()=>e(l),B=>d(l,B)),O(i,N),he()}Le(["input"]);var Ka=q('<div class="mr-2 flex flex-row justify-center"><div class="inline-block h-6 w-6"><!></div></div>'),Ea=q('<form><!> <div class="flex flex-row justify-end"><button type="submit" class="btn primary flex flex-shrink"><!> </button></div></form>');function Ta(i,r){me(r,!0);let l=c(!1),f=c(!1),h=M(()=>e(l)||!e(f)),g=c(u(r.tenant.algorithm)),k=c(u(r.tenant.audience)),x=c(u(r.tenant.clientId)),K=c(u(r.tenant.expiresInSeconds)),E=c(u(r.tenant.issuer)),y=c(u(r.tenant.privateKey)),C=c(u(r.tenant.publicKey)),N=c(u(r.tenant.refreshExpiresInSeconds));async function I(n){n.preventDefault();try{d(l,!0),e(f)&&r.onEdit(await Ge.updateTenant(r.tenant.id,{algorithm:e(g),audience:e(k),clientId:e(x)?e(x):void 0,expiresInSeconds:e(K),issuer:e(E),privateKey:e(y)?e(y):void 0,publicKey:e(C)?e(C):void 0,refreshExpiresInSeconds:e(N)},r.applicationId))}catch(j){await et(j)}finally{d(l,!1)}}var _=Ea(),b=a(_);pt(b,{get algorithm(){return e(g)},set algorithm(n){d(g,u(n))},get audience(){return e(k)},set audience(n){d(k,u(n))},get clientId(){return e(x)},set clientId(n){d(x,u(n))},get expiresInSeconds(){return e(K)},set expiresInSeconds(n){d(K,u(n))},get issuer(){return e(E)},set issuer(n){d(E,u(n))},get privateKey(){return e(y)},set privateKey(n){d(y,u(n))},get publicKey(){return e(C)},set publicKey(n){d(C,u(n))},get refreshExpiresInSeconds(){return e(N)},set refreshExpiresInSeconds(n){d(N,u(n))},get valid(){return e(f)},set valid(n){d(f,u(n))}});var A=s(b,2),P=a(A),T=a(P);{var L=n=>{var j=Ka(),D=a(j),B=a(D);$e(B),t(D),t(j),O(n,j)};De(T,n=>{e(l)&&n(L)})}var G=s(T);o(()=>p(G,` ${Lt()??""}`)),t(P),t(A),t(_),o(()=>P.disabled=e(h)),Je("submit",_,I),O(i,_),he()}const rt=20;var Ca=q('<button class="btn secondary icon lg"><!></button>'),Na=q('<a class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></a> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button> <button class="flex cursor-pointer flex-row justify-between p-2 hover:bg-gray-200 dark:hover:bg-gray-600"><!><span class="ms-4"> </span></button>',1),Aa=q('<tr class="group"><td> </td><td> </td><td> </td><td> </td><td> </td><td class="flex justify-end"><div class="flex flex-shrink"><!></div></td></tr>'),ja=q("<h3> </h3>"),Da=q("<h3> </h3>"),Pa=q("<h3> </h3>"),Ba=q('<table class="table-auto w-full"><thead><tr class="text-left border-b"><th> </th><th> </th><th> </th><th> </th><th> </th><th></th></tr></thead><tbody></tbody></table> <!> <!> <!>',1);function Oa(i,r){me(r,!0);let l=R(r,"tenants",31,()=>u([])),f=c(0),h=c(!0),g=c(!1);ot(k);async function k(){if(!e(h)||e(g))return;let m;d(g,!0);try{m=await Ge.allTenants(e(f)*rt,rt,!0,r.applicationId)}finally{d(g,!1)}d(h,u(m.hasMore)),d(f,e(f)+1),l().push(...m.items)}let x=c(!1);function K(){d(x,!0)}function E(m){l().unshift(m),d(x,!1)}let y=c(void 0),C=c(!1);function N(m){return()=>{d(y,u(m)),d(C,!0)}}function I(m){const v=l().findIndex(S=>S.id===(m==null?void 0:m.id));v!==-1&&l(l()[v]=m,!0),d(y,void 0),d(C,!1)}let _=c(void 0),b=c(!1);function A(m){return()=>{d(_,u(m)),d(b,!0)}}function P(){const m=l().findIndex(v=>{var S;return v.id===((S=e(_))==null?void 0:S.id)});m!==-1&&l().splice(m,1),d(_,void 0),d(b,!1)}const T=lt(),[L,G]=T;var n=Ba(),j=Ae(n),D=a(j),B=a(D),U=a(B),fe=a(U,!0);o(()=>p(fe,Ut())),t(U);var Q=s(U),ge=a(Q,!0);o(()=>p(ge,Yt())),t(Q);var xe=s(Q),te=a(xe,!0);o(()=>p(te,Zt())),t(xe);var ye=s(xe),Ve=a(ye,!0);o(()=>p(Ve,zt())),t(ye);var pe=s(ye),Ie=a(pe,!0);o(()=>p(Ie,Qt())),t(pe),bt(),t(B),t(D);var Pe=s(D);st(Pe,23,l,m=>m.id,(m,v,S)=>{var w=Aa(),F=a(w),le=a(F,!0);t(F);var H=s(F),Se=a(H,!0);t(H);var we=s(H),ae=a(we,!0);t(we);var ke=s(we),Ue=a(ke,!0);o(()=>p(Ue,e(v).updatedAt.toLocaleString())),t(ke);var re=s(ke),Ke=a(re,!0);o(()=>p(Ke,e(v).createdAt.toLocaleString())),t(re);var Oe=s(re),X=a(Oe),Ye=a(X);na(Ye,{position:"top-right",anchorPosition:"bottom-right",button:de=>{var ne=Ca(),be=a(ne);la(be,{}),t(ne),O(de,ne)},children:(de,ne)=>{var be=Na(),oe=Ae(be);o(()=>z(oe,"href",L(`${dt}/applications/${r.applicationId}/tenants/${e(v).id}/oauth2-providers`,void 0)));var Me=a(oe);ua(Me,{});var qe=s(Me),Ze=a(qe,!0);o(()=>p(Ze,Wt())),t(qe),t(oe);var ue=s(oe,2),Ee=M(()=>N(e(v)));ue.__click=function(...Ce){var Ne;(Ne=e(Ee))==null||Ne.apply(this,Ce)};var Fe=a(ue);ia(Fe,{});var J=s(Fe),ze=a(J,!0);o(()=>p(ze,Xt())),t(J),t(ue);var Te=s(ue,2),V=M(()=>A(e(v)));Te.__click=function(...Ce){var Ne;(Ne=e(V))==null||Ne.apply(this,Ce)};var ve=a(Te);sa(ve,{});var ie=s(ve),He=a(ie,!0);o(()=>p(He,Jt())),t(ie),t(Te),O(de,be)},$$slots:{button:!0,default:!0}}),t(X),t(Oe),t(w),o(()=>{Gt(w,"border-b",e(S)<l().length-1),p(le,e(v).id),p(Se,e(v).issuer),p(ae,e(v).clientId)}),O(m,w)}),t(Pe),t(j);var W=s(j,2);Qe(W,{get open(){return e(x)},set open(v){d(x,u(v))},title:v=>{var S=ja(),w=a(S,!0);o(()=>p(w,$t())),t(S),O(v,S)},children:(v,S)=>{xa(v,{get applicationId(){return r.applicationId},onCreate:E})},$$slots:{title:!0,default:!0}});var Be=s(W,2);Qe(Be,{get open(){return e(C)},set open(v){d(C,u(v))},title:v=>{var S=Da(),w=a(S,!0);o(()=>{var F;return p(w,Vt({issuer:((F=e(y))==null?void 0:F.issuer)||""}))}),t(S),O(v,S)},children:(v,S)=>{var w=at(),F=Ae(w);{var le=H=>{Ta(H,{get applicationId(){return r.applicationId},get tenant(){return e(y)},onEdit:I})};De(F,H=>{e(y)&&H(le)})}O(v,w)},$$slots:{title:!0,default:!0}});var Re=s(Be,2);return Qe(Re,{get open(){return e(b)},set open(v){d(b,u(v))},title:v=>{var S=Pa(),w=a(S,!0);o(()=>{var F;return p(w,Rt({issuer:((F=e(_))==null?void 0:F.issuer)||""}))}),t(S),O(v,S)},children:(v,S)=>{var w=at(),F=Ae(w);{var le=H=>{ka(H,{get applicationId(){return r.applicationId},get tenantId(){return e(_).id},get issuer(){return e(_).issuer},onDelete:P})};De(F,H=>{e(_)&&H(le)})}O(v,w)},$$slots:{title:!0,default:!0}}),O(i,n),he({onCreate:K})}Le(["click"]);var Ma=q('<div class="container mx-auto my-4"><div class="bg-white dark:bg-gray-800 shadow-lg p-4 rounded-lg"><div class="flex flex-grow justify-between"><a class="flex flex-row items-center"><button class="btn primary icon"><!></button> <span class="ms-2"> </span></a> <button class="btn primary icon lg"><!></button></div> <!></div></div>');function er(i,r){me(r,!0);let l=c(void 0);const f=lt(),[h,g]=f;var k=Ma();gt(P=>{o(()=>mt.title=ea())});var x=a(k),K=a(x),E=a(K);o(()=>z(E,"href",h(`${dt}/`,void 0)));var y=a(E),C=a(y);va(C,{}),t(y);var N=s(y,2),I=a(N,!0);o(()=>p(I,ta())),t(N),t(E);var _=s(E,2);_.__click=function(...P){var T,L;(L=(T=e(l))==null?void 0:T.onCreate)==null||L.apply(this,P)};var b=a(_);da(b,{}),t(_),t(K);var A=s(K,2);ra(Oa(A,{get applicationId(){return r.data.applicationId}}),P=>d(l,u(P)),()=>e(l)),t(x),t(k),O(i,k),he()}Le(["click"]);export{er as component};
