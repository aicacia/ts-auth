import{j as ge,r as we,k as be}from"../chunks/utils.C9MzFJhm.js";import{S as ke,i as Ee,s as A,g as b,m as Y,r as le,I as ye,f as h,c as D,h as k,j as y,n as Z,u as ne,k as n,a as x,C as u,J as X,v as re,D as K,K as Ie,o as ee,d as q,t as R,b as $e,w as ie,p as Se}from"../chunks/index.Cgbm_bxH.js";import{I as pe,d as Ve,i as je,S as Ae,K as De,V as Te,v as ce,w as me}from"../chunks/Spinner.tRxFEDtF.js";import{L as Pe}from"../chunks/i18n-svelte.g6RidGeH.js";import{g as _e}from"../chunks/navigation.8QQJ154a.js";import{b as oe}from"../chunks/paths.eUxvDbcf.js";import{j as Ne}from"../chunks/user.KYivON0R.js";import{h as Oe}from"../chunks/errors.21Pt_TCp.js";import{g as Ue,i as Le}from"../chunks/oauth2.VZ5-nowa.js";const Me=!1,qe=async e=>{const{signUpMethods:a}=await e.parent(),s=e.url.searchParams.get("code");return{signUpMethods:a,code:s}},Ye=Object.freeze(Object.defineProperty({__proto__:null,load:qe,prerender:Me},Symbol.toStringTag,{value:"Module"}));function he(e){let a,s,i=e[7].not_a_member()+"",o,f,d,g=e[7].sign_up()+"",E;return{c(){a=b("p"),s=b("span"),o=Y(i),f=A(),d=b("a"),E=Y(g),this.h()},l(c){a=k(c,"P",{class:!0});var r=y(a);s=k(r,"SPAN",{});var v=y(s);o=Z(v,i),v.forEach(h),f=D(r),d=k(r,"A",{href:!0,class:!0});var p=y(d);E=Z(p,g),p.forEach(h),r.forEach(h),this.h()},h(){n(d,"href",`${oe}/signup`),n(d,"class","underline text-blue-500"),n(a,"class","py-2")},m(c,r){x(c,a,r),u(a,s),u(s,o),u(a,f),u(a,d),u(d,E)},p(c,r){r&128&&i!==(i=c[7].not_a_member()+"")&&ee(o,i),r&128&&g!==(g=c[7].sign_up()+"")&&ee(E,g)},d(c){c&&h(a)}}}function ve(e){let a,s,i,o;return i=new Ae({}),{c(){a=b("div"),s=b("div"),le(i.$$.fragment),this.h()},l(f){a=k(f,"DIV",{class:!0});var d=y(a);s=k(d,"DIV",{class:!0});var g=y(s);ne(i.$$.fragment,g),g.forEach(h),d.forEach(h),this.h()},h(){n(s,"class","inline-block w-6 h-6"),n(a,"class","flex flex-row justify-center mr-2")},m(f,d){x(f,a,d),u(a,s),re(i,s,null),o=!0},i(f){o||(q(i.$$.fragment,f),o=!0)},o(f){R(i.$$.fragment,f),o=!1},d(f){f&&h(a),ie(i)}}}function ze(e){let a,s,i,o,f,d=e[7].sign_in()+"",g,E,c,r,v,p,N,O,T,S,z,V,l,U,F,te,P,ae,L,I,H,B=e[7].sign_in()+"",J,$,se,ue;document.title=a=e[7].sign_in();let w=e[0].signUpMethods.enabled&&he(e);S=new pe({props:{name:"username",result:e[1]}}),P=new pe({props:{name:"password",result:e[1]}});let m=e[2]&&ve();return{c(){s=A(),i=b("div"),o=b("div"),f=b("h1"),g=Y(d),E=A(),w&&w.c(),c=A(),r=b("form"),v=b("div"),p=b("input"),T=A(),le(S.$$.fragment),z=A(),V=b("div"),l=b("input"),te=A(),le(P.$$.fragment),ae=A(),L=b("div"),I=b("button"),m&&m.c(),H=A(),J=Y(B),this.h()},l(t){ye("svelte-1kk4d8a",document.head).forEach(h),s=D(t),i=k(t,"DIV",{class:!0});var C=y(i);o=k(C,"DIV",{class:!0});var j=y(o);f=k(j,"H1",{class:!0});var fe=y(f);g=Z(fe,d),fe.forEach(h),E=D(j),w&&w.l(j),c=D(j),r=k(j,"FORM",{});var M=y(r);v=k(M,"DIV",{class:!0});var G=y(v);p=k(G,"INPUT",{class:!0,type:!0,name:!0,autocomplete:!0,placeholder:!0}),T=D(G),ne(S.$$.fragment,G),G.forEach(h),z=D(M),V=k(M,"DIV",{class:!0});var Q=y(V);l=k(Q,"INPUT",{class:!0,type:!0,name:!0,autocomplete:!0,placeholder:!0}),te=D(Q),ne(P.$$.fragment,Q),Q.forEach(h),ae=D(M),L=k(M,"DIV",{class:!0});var de=y(L);I=k(de,"BUTTON",{type:!0,class:!0});var W=y(I);m&&m.l(W),H=D(W),J=Z(W,B),W.forEach(h),de.forEach(h),M.forEach(h),j.forEach(h),C.forEach(h),this.h()},h(){n(f,"class","mb-1"),n(p,"class",N="w-full "+e[5]("username")),n(p,"type","text"),n(p,"name","username"),n(p,"autocomplete","username"),n(p,"placeholder",O=e[7].username_placeholder()),n(v,"class","mb-2"),n(l,"class",U="w-full "+e[5]("password")),n(l,"type","password"),n(l,"name","password"),n(l,"autocomplete","current-password"),n(l,"placeholder",F=e[7].password_placeholder()),n(V,"class","mb-2"),n(I,"type","submit"),n(I,"class","btn primary flex flex-shrink"),I.disabled=e[6],n(L,"class","flex flex-row justify-end"),n(o,"class","flex flex-col flex-shrink md:w-72 w-full mx-auto my-10 bg-white dark:bg-gray-800 shadow p-4"),n(i,"class","flex flex-col flex-grow justify-end md:justify-start")},m(t,_){x(t,s,_),x(t,i,_),u(i,o),u(o,f),u(f,g),u(o,E),w&&w.m(o,null),u(o,c),u(o,r),u(r,v),u(v,p),X(p,e[3]),u(v,T),re(S,v,null),u(r,z),u(r,V),u(V,l),X(l,e[4]),u(V,te),re(P,V,null),u(r,ae),u(r,L),u(L,I),m&&m.m(I,null),u(I,H),u(I,J),$=!0,se||(ue=[K(p,"input",e[10]),K(p,"input",e[8]),K(l,"input",e[11]),K(l,"input",e[8]),K(r,"submit",Ie(e[9]))],se=!0)},p(t,[_]){(!$||_&128)&&a!==(a=t[7].sign_in())&&(document.title=a),(!$||_&128)&&d!==(d=t[7].sign_in()+"")&&ee(g,d),t[0].signUpMethods.enabled?w?w.p(t,_):(w=he(t),w.c(),w.m(o,c)):w&&(w.d(1),w=null),(!$||_&32&&N!==(N="w-full "+t[5]("username")))&&n(p,"class",N),(!$||_&128&&O!==(O=t[7].username_placeholder()))&&n(p,"placeholder",O),_&8&&p.value!==t[3]&&X(p,t[3]);const C={};_&2&&(C.result=t[1]),S.$set(C),(!$||_&32&&U!==(U="w-full "+t[5]("password")))&&n(l,"class",U),(!$||_&128&&F!==(F=t[7].password_placeholder()))&&n(l,"placeholder",F),_&16&&l.value!==t[4]&&X(l,t[4]);const j={};_&2&&(j.result=t[1]),P.$set(j),t[2]?m?_&4&&q(m,1):(m=ve(),m.c(),q(m,1),m.m(I,H)):m&&(Se(),R(m,1,1,()=>{m=null}),$e()),(!$||_&128)&&B!==(B=t[7].sign_in()+"")&&ee(J,B),(!$||_&64)&&(I.disabled=t[6])},i(t){$||(q(S.$$.fragment,t),q(P.$$.fragment,t),q(m),$=!0)},o(t){R(S.$$.fragment,t),R(P.$$.fragment,t),R(m),$=!1},d(t){t&&(h(s),h(i)),w&&w.d(),ie(S),ie(P),m&&m.d(),se=!1,we(ue)}}}const Be=()=>De((e={},a)=>{a.length&&(Te(a),ce("username","required",()=>{me(e.username).isNotBlank()}),ce("password","required",()=>{me(e.password).isNotBlank()}))});function Ce(e,a,s){let i,o,f;be(e,Pe,l=>s(7,f=l));let{data:d}=a;const g=Be();let E="",c="",r=g.get();const v=new Set,p=Ve(()=>{g({username:E,password:c},Array.from(v)).done(l=>{s(1,r=l)}),v.clear()},300);function N(){v.add("username"),v.add("password"),p(),p.flush()}function O(l){l.currentTarget.value=l.currentTarget.value.trim(),v.add(l.currentTarget.name),p()}let T=!1;async function S(l){try{s(2,T=!0),N(),r.isValid()&&(await Ne(E,c),Le()?await _e(`${oe}/oauth2/authorize`):await _e(`${oe}/`))}catch(U){await Oe(U)}finally{s(2,T=!1)}}function z(){E=this.value,s(3,E)}function V(){c=this.value,s(4,c)}return e.$$set=l=>{"data"in l&&s(0,d=l.data)},e.$$.update=()=>{e.$$.dirty&1&&d.code&&Ue(d.code),e.$$.dirty&4&&s(6,i=T),e.$$.dirty&2&&s(5,o=je(r,{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}))},[d,r,T,E,c,o,i,f,O,S,z,V]}class Ze extends ke{constructor(a){super(),Ee(this,a,Ce,ze,ge,{data:0})}}export{Ze as component,Ye as universal};
